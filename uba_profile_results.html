<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBA 프로파일 분석 결과</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a2332 100%);
            color: #e2e8f0;
            min-height: 100vh;
            font-size: 0.9rem;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(51, 65, 85, 0.3);
        }

        .header-title h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.3rem;
        }

        .header-title p {
            color: #94a3b8;
            font-size: 0.95rem;
        }

        .profile-header {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(51, 65, 85, 0.3);
            border-radius: 0.6rem;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 0.4rem;
            color: #f1f5f9;
        }

        .profile-meta {
            display: flex;
            gap: 1.5rem;
            margin-top: 0.75rem;
        }

        .profile-meta-item {
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }

        .meta-label {
            font-size: 0.85rem;
            color: #94a3b8;
        }

        .meta-value {
            font-size: 1rem;
            color: #e2e8f0;
        }

        .profile-score {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 135px;
        }

        .profile-nav {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid rgba(51, 65, 85, 0.3);
        }

        .nav-item {
            padding: 0.6rem 1.25rem;
            font-size: 0.95rem;
            font-weight: 500;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 2px solid transparent;
            text-decoration: none;
        }

        .nav-item:hover {
            color: #e2e8f0;
        }

        .nav-item.active {
            color: #6366f1;
            border-bottom: 2px solid #6366f1;
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: conic-gradient(#6366f1 0%, #6366f1 70%, #1f2937 70%, #1f2937 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-bottom: 0.4rem;
        }

        .score-circle::after {
            content: '';
            position: absolute;
            width: 85px;
            height: 85px;
            border-radius: 50%;
            background: #1a2332;
        }

        .score-value {
            position: relative;
            z-index: 1;
            font-size: 1.8rem;
            font-weight: 700;
            color: #f1f5f9;
        }

        .score-label {
            font-size: 0.85rem;
            color: #94a3b8;
            text-align: center;
        }

        .risk-level {
            font-size: 1rem;
            font-weight: 600;
            color: #a5b4fc;
            margin-top: 0.4rem;
        }

        .btn {
            padding: 0.6rem 1.25rem;
            border: none;
            border-radius: 0.4rem;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5856eb, #7c3aed);
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: rgba(51, 65, 85, 0.7);
            color: #e2e8f0;
            border: 1px solid rgba(51, 65, 85, 0.5);
        }

        .btn-secondary:hover {
            background: rgba(51, 65, 85, 0.9);
            transform: translateY(-2px);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .dashboard-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(51, 65, 85, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #f1f5f9;
        }

        .card-actions {
            display: flex;
            gap: 0.5rem;
        }

        .card-action {
            background: rgba(51, 65, 85, 0.5);
            border: none;
            border-radius: 0.375rem;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #94a3b8;
        }

        .card-action:hover {
            background: rgba(51, 65, 85, 0.8);
            color: #e2e8f0;
        }

        .chart-container {
            flex: 1;
            position: relative;
            min-height: 250px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .metric-item {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 0.5rem;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .metric-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .metric-name {
            font-size: 0.9rem;
            color: #94a3b8;
        }

        .metric-value {
            font-size: 1.25rem;
            color: #f1f5f9;
            font-weight: 600;
        }

        .metric-indicator {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .indicator-normal {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .indicator-warning {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .indicator-critical {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .table-container {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(51, 65, 85, 0.3);
        }

        .data-table th {
            font-weight: 600;
            color: #94a3b8;
            font-size: 0.9rem;
        }

        .data-table tbody tr {
            transition: background-color 0.2s;
        }

        .data-table tbody tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .severity-high {
            color: #ef4444;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .severity-medium {
            color: #f59e0b;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .severity-low {
            color: #10b981;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .severity-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .severity-high .severity-indicator {
            background-color: #ef4444;
        }

        .severity-medium .severity-indicator {
            background-color: #f59e0b;
        }

        .severity-low .severity-indicator {
            background-color: #10b981;
        }

        .recommendations {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .recommendation-item {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 0.5rem;
            padding: 1.25rem;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .recommendation-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(99, 102, 241, 0.2);
            color: #a5b4fc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .recommendation-content {
            flex: 1;
        }

        .recommendation-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 0.5rem;
        }

        .recommendation-text {
            color: #94a3b8;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .activity-timeline {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding-left: 1rem;
            position: relative;
        }

        .activity-timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 10px;
            bottom: 10px;
            width: 2px;
            background: rgba(51, 65, 85, 0.5);
        }

        .timeline-item {
            position: relative;
            padding-left: 1.5rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -5px;
            top: 6px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #6366f1;
            border: 2px solid #1a2332;
        }

        .timeline-time {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-bottom: 0.25rem;
        }

        .timeline-content {
            font-size: 0.9rem;
            color: #e2e8f0;
            line-height: 1.4;
        }

        .timeline-anomaly {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid rgba(239, 68, 68, 0.5);
            padding: 0.5rem;
            margin-top: 0.5rem;
            border-radius: 0 0.25rem 0.25rem 0;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        @media (max-width: 992px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .profile-header {
                flex-direction: column;
                gap: 1.5rem;
            }

            .profile-score {
                align-self: center;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 차트 스타일 */
        .chart-placeholder {
            width: 100%;
            height: 250px;
            background: rgba(15, 23, 42, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            color: #94a3b8;
            font-size: 0.9rem;
        }

        /* 베이스라인 메트릭 비교 스타일 */
        .baseline-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 1rem;
        }

        .baseline-metric-item {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .baseline-metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .baseline-metric-name {
            font-size: 0.95rem;
            color: #94a3b8;
        }

        .baseline-deviation {
            font-size: 0.9rem;
            font-weight: 600;
            padding: 0.15rem 0.5rem;
            border-radius: 9999px;
        }

        .baseline-deviation.low {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .baseline-deviation.medium {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .baseline-deviation.high {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .baseline-comparison-bar {
            height: 30px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 4px;
            position: relative;
            margin-top: 0.5rem;
        }

        .baseline-normal-range {
            position: absolute;
            top: 0;
            height: 100%;
            background: rgba(74, 222, 128, 0.2);
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 0.5rem;
        }

        .baseline-min, .baseline-max {
            font-size: 0.75rem;
            color: #4ade80;
        }

        .baseline-current-value {
            position: absolute;
            top: -20px;
            transform: translateX(-50%);
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: #818cf8;
            padding: 0.15rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.8rem;
            white-space: nowrap;
        }

        .baseline-current-value::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid rgba(99, 102, 241, 0.3);
        }

        .heatmap-container {
            height: 200px;
            background: rgba(15, 23, 42, 0.3);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @media (max-width: 992px) {
            .baseline-metrics {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <div class="header-title">
                <h1>UBA 프로파일 분석 결과</h1>
                <p>사용자 행동 분석 결과 및 이상 징후를 확인하세요</p>
            </div>
            <button class="btn btn-secondary" onclick="goBackToList()">
                ← 목록으로 돌아가기
            </button>
        </div>

        <div class="profile-header">
            <div class="profile-info">
                <h2 class="profile-name" id="profileName">UBA 프로파일 이름</h2>
                <div class="profile-meta">
                    <div class="profile-meta-item">
                        <div class="meta-label">프로파일 유형</div>
                        <div class="meta-value" id="profileType">사용자 프로파일</div>
                    </div>
                    <div class="profile-meta-item">
                        <div class="meta-label">로그 소스</div>
                        <div class="meta-value" id="logSource">Windows 이벤트 로그</div>
                    </div>
                    <div class="profile-meta-item">
                        <div class="meta-label">분석 기간</div>
                        <div class="meta-value" id="analysisPeriod">2025-05-01 ~ 2025-06-01</div>
                    </div>
                    <div class="profile-meta-item">
                        <div class="meta-label">생성일</div>
                        <div class="meta-value" id="creationDate">2025-04-15</div>
                    </div>
                </div>
            </div>
            <div class="profile-score">
                <div class="score-circle">
                    <div class="score-value" id="riskScore">70</div>
                </div>
                <div class="score-label">위험 점수</div>
                <div class="risk-level" id="riskLevel">중간 위험</div>
            </div>
        </div>

        <div class="profile-nav">
            <a href="uba_profile_results.html" class="nav-item active">분석 결과</a>
            <a href="uba_baseline_management.html" class="nav-item">베이스라인 관리</a>
        </div>

        <div class="dashboard-grid">
            <!-- 시간별 활동 그래프 -->
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h3 class="card-title">기간별 활동 추이</h3>
                    <div class="card-actions">
                        <button class="card-action" title="일간 보기" onclick="changeActivityTimeframe('daily')">D</button>
                        <button class="card-action" title="주간 보기" onclick="changeActivityTimeframe('weekly')">W</button>
                        <button class="card-action" title="월간 보기" onclick="changeActivityTimeframe('monthly')">M</button>
                    </div>
                </div>
                <div class="chart-container" id="activityTrendChart">
                    <div class="chart-placeholder">차트를 로드하는 중...</div>
                </div>
            </div>

            <!-- 핵심 지표 -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">핵심 행동 지표</h3>
                </div>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-name">로그인 시도</div>
                            <div class="metric-value">47회</div>
                        </div>
                        <div class="metric-indicator indicator-normal">✓</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-name">업무시간 외 활동</div>
                            <div class="metric-value">12%</div>
                        </div>
                        <div class="metric-indicator indicator-normal">✓</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-name">파일 다운로드</div>
                            <div class="metric-value">367MB</div>
                        </div>
                        <div class="metric-indicator indicator-warning">!</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-name">IP 주소 변경</div>
                            <div class="metric-value">3회</div>
                        </div>
                        <div class="metric-indicator indicator-warning">!</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-name">인증 실패</div>
                            <div class="metric-value">2회</div>
                        </div>
                        <div class="metric-indicator indicator-normal">✓</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-name">권한 상승 시도</div>
                            <div class="metric-value">1회</div>
                        </div>
                        <div class="metric-indicator indicator-critical">!</div>
                    </div>
                </div>
            </div>

            <!-- 최근 활동 타임라인 -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">최근 활동 및 이상 징후</h3>
                </div>
                <div class="activity-timeline">
                    <div class="timeline-item">
                        <div class="timeline-time">2025-06-01 09:32</div>
                        <div class="timeline-content">로그인 성공 (192.168.1.45)</div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-time">2025-06-01 10:15</div>
                        <div class="timeline-content">기밀 문서 액세스 (HR/salary_2025.xlsx)</div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-time">2025-06-01 11:42</div>
                        <div class="timeline-content">대용량 파일 다운로드 (237MB)</div>
                        <div class="timeline-anomaly">이상 징후: 일반적인 다운로드 패턴보다 5배 큰 용량</div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-time">2025-06-01 14:26</div>
                        <div class="timeline-content">권한 상승 명령 실행 (sudo)</div>
                        <div class="timeline-anomaly">이상 징후: 사용자가 이전에 권한 상승을 시도한 적이 없음</div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-time">2025-06-01 16:58</div>
                        <div class="timeline-content">로그아웃</div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-time">2025-06-01 23:15</div>
                        <div class="timeline-content">로그인 시도 (원격 IP: 203.45.67.89)</div>
                        <div class="timeline-anomaly">이상 징후: 업무 시간 외 접속 + 비정상적인 위치 (중국)</div>
                    </div>
                </div>
            </div>

            <!-- 탐지된 이상 징후 목록 -->
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h3 class="card-title">탐지된 이상 징후</h3>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>탐지 일시</th>
                                <th>이상 징후 유형</th>
                                <th>심각도</th>
                                <th>세부 정보</th>
                                <th>조치 상태</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2025-06-01 23:15</td>
                                <td>업무시간 외 접속</td>
                                <td>
                                    <div class="severity-high">
                                        <div class="severity-indicator"></div>
                                        높음
                                    </div>
                                </td>
                                <td>중국 베이징 (203.45.67.89)에서 23:15에 접속 시도</td>
                                <td>조사 중</td>
                            </tr>
                            <tr>
                                <td>2025-06-01 14:26</td>
                                <td>권한 상승 시도</td>
                                <td>
                                    <div class="severity-high">
                                        <div class="severity-indicator"></div>
                                        높음
                                    </div>
                                </td>
                                <td>관리자 권한 획득 시도 (sudo 명령어 사용)</td>
                                <td>조사 중</td>
                            </tr>
                            <tr>
                                <td>2025-06-01 11:42</td>
                                <td>비정상 다운로드</td>
                                <td>
                                    <div class="severity-medium">
                                        <div class="severity-indicator"></div>
                                        중간
                                    </div>
                                </td>
                                <td>237MB 크기의 파일 다운로드 (일반 패턴의 5배)</td>
                                <td>확인 완료</td>
                            </tr>
                            <tr>
                                <td>2025-05-28 16:35</td>
                                <td>계정 공유 의심</td>
                                <td>
                                    <div class="severity-medium">
                                        <div class="severity-indicator"></div>
                                        중간
                                    </div>
                                </td>
                                <td>30분 간격으로 서울과 부산에서 동시 접속</td>
                                <td>확인 완료</td>
                            </tr>
                            <tr>
                                <td>2025-05-25 10:12</td>
                                <td>민감 정보 접근</td>
                                <td>
                                    <div class="severity-low">
                                        <div class="severity-indicator"></div>
                                        낮음
                                    </div>
                                </td>
                                <td>HR 디렉토리 내 급여 정보 파일 접근</td>
                                <td>확인 완료</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 행동 패턴 분석 결과 -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">행동 패턴 분석</h3>
                    <div class="card-actions">
                        <button class="card-action" title="베이스라인 비교 표시" onclick="toggleBaselineComparison(true)">B</button>
                        <button class="card-action" title="현재 행동만 표시" onclick="toggleBaselineComparison(false)">C</button>
                    </div>
                </div>
                <div class="chart-container" id="behaviorPatternChart">
                    <div class="chart-placeholder">레이더 차트를 로드하는 중...</div>
                </div>
                <div class="baseline-legend" style="display: flex; justify-content: center; margin-top: 10px; gap: 20px; font-size: 0.9rem;">
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 12px; height: 12px; background: rgba(99, 102, 241, 0.6); border-radius: 50%;"></div>
                        <span>현재 행동</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 12px; height: 12px; background: rgba(74, 222, 128, 0.3); border-radius: 50%;"></div>
                        <span>정상 베이스라인</span>
                    </div>
                </div>
            </div>

            <!-- 조치 권장사항 -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">조치 권장사항</h3>
                </div>
                <div class="recommendations">
                    <div class="recommendation-item">
                        <div class="recommendation-icon">🔒</div>
                        <div class="recommendation-content">
                            <div class="recommendation-title">계정 보안 강화</div>
                            <div class="recommendation-text">2단계 인증(MFA)을 활성화하고 정기적인 비밀번호 변경을 요청하세요.</div>
                        </div>
                    </div>
                    <div class="recommendation-item">
                        <div class="recommendation-icon">🌐</div>
                        <div class="recommendation-content">
                            <div class="recommendation-title">IP 제한 설정</div>
                            <div class="recommendation-text">허용된 IP 주소 또는 지역에서만 접속을 허용하도록 설정하세요.</div>
                        </div>
                    </div>
                    <div class="recommendation-item">
                        <div class="recommendation-icon">⏰</div>
                        <div class="recommendation-content">
                            <div class="recommendation-title">업무시간 접속 제한</div>
                            <div class="recommendation-text">업무시간 외 접속 시 추가 인증을 요구하는 정책을 적용하세요.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 조치 권장사항 카드 앞에 새로운 베이스라인 정보 카드 추가 -->
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h3 class="card-title">학습된 베이스라인 정보</h3>
                    <div class="card-actions">
                        <button class="card-action" title="베이스라인 상세 정보" onclick="showBaselineDetails()">ℹ️</button>
                    </div>
                </div>

                <div style="padding: 0 0 1rem 0;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; background: rgba(15, 23, 42, 0.3); padding: 1rem; border-radius: 0.5rem;">
                        <div>
                            <div style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.25rem;">학습 기간</div>
                            <div style="font-size: 1.1rem; color: #f1f5f9;"><span id="learningDays">30</span>일</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.25rem;">처리된 데이터</div>
                            <div style="font-size: 1.1rem; color: #f1f5f9;"><span id="processedEvents">14,589</span>개 이벤트</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.25rem;">마지막 업데이트</div>
                            <div style="font-size: 1.1rem; color: #f1f5f9;"><span id="lastUpdated">2025-06-01 06:00</span></div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.25rem;">베이스라인 품질</div>
                            <div style="font-size: 1.1rem; color: #4ade80;">양호</div>
                        </div>
                    </div>

                    <h4 style="margin: 1.5rem 0 1rem 0; font-size: 1.1rem; color: #f1f5f9;">주요 메트릭 베이스라인 비교</h4>

                    <div class="baseline-metrics" id="baselineMetricsContainer">
                        <!-- 여기에 동적으로 메트릭이 추가됩니다 -->
                    </div>

                    <h4 style="margin: 1.5rem 0 1rem 0; font-size: 1.1rem; color: #f1f5f9;">시간대별 활동 패턴</h4>
                    <div class="heatmap-container">
                        <div class="chart-placeholder">시간대별 활동 히트맵을 로드하는 중...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <button class="btn btn-secondary" onclick="goBackToList()">목록으로 돌아가기</button>
            <button class="btn btn-primary" onclick="exportReport()">분석 결과 다운로드</button>
        </div>
    </div>

    <script>
        let profileData = null;

        // 페이지 로드 시 실행
        document.addEventListener('DOMContentLoaded', () => {
            // URL에서 프로필 ID 가져오기
            const urlParams = new URLSearchParams(window.location.search);
            const profileId = urlParams.get('id');

            if (profileId) {
                loadProfileResults(profileId);

                // 네비게이션 탭의 href 속성 업데이트
                const navLinks = document.querySelectorAll('.profile-nav a');
                navLinks.forEach(link => {
                    const href = link.getAttribute('href');
                    link.setAttribute('href', `${href}?id=${profileId}`);
                });
            } else {
                alert('프로필 정보를 찾을 수 없습니다.');
                goBackToList();
            }

            // 차트 초기화 (실제로는 Chart.js 등의 라이브러리를 사용할 것)
            simulateChartLoading();
        });

        // 프로필 결과 로드
        function loadProfileResults(profileId) {
            // 로컬 스토리지에서 프로필 기본 정보 가져오기
            const profiles = localStorage.getItem('ubaProfiles');
            if (!profiles) {
                alert('프로필 정보를 찾을 수 없습니다.');
                goBackToList();
                return;
            }

            const profileList = JSON.parse(profiles);
            profileData = profileList.find(p => p.id === profileId);

            if (!profileData) {
                alert('해당 프로필을 찾을 수 없습니다.');
                goBackToList();
                return;
            }

            // 프로필 정보 표시
            displayProfileInfo(profileData);

            // 분석 결과 데이터 생성 (실제로는 서버에서 가져와야 함)
            generateMockAnalysisData(profileData);

            // 베이스라인 정보 데이터 채우기
            updateBaselineInfo();
        }

        // 프로필 기본 정보 표시
        function displayProfileInfo(profile) {
            document.getElementById('profileName').textContent = profile.name;

            // 프로파일 유형
            let profileTypeText;
            switch (profile.profileType) {
                case 'user': profileTypeText = '사용자'; break;
                case 'entity': profileTypeText = '엔터티'; break;
                case 'hybrid': profileTypeText = '하이브리드'; break;
                default: profileTypeText = '사용자 정의';
            }
            document.getElementById('profileType').textContent = profileTypeText + ' 프로파일';

            // 로그 소스
            document.getElementById('logSource').textContent = profile.logSourceName || '-';

            // 분석 기간 (가상 데이터)
            const today = new Date();
            const startDate = new Date();
            startDate.setDate(today.getDate() - (profile.learningPeriod || 30));

            const formatDate = (date) => {
                return date.toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                }).replace(/\. /g, '-').replace('.', '');
            };

            document.getElementById('analysisPeriod').textContent =
                `${formatDate(startDate)} ~ ${formatDate(today)}`;

            // 생성일
            if (profile.createdAt) {
                const createdDate = new Date(profile.createdAt);
                document.getElementById('creationDate').textContent = formatDate(createdDate);
            } else {
                document.getElementById('creationDate').textContent = '-';
            }

            // 위험 점수 (가상 데이터)
            const riskScore = Math.floor(Math.random() * 40) + 40; // 40-80 범위
            document.getElementById('riskScore').textContent = riskScore;

            // 위험 수준 설정
            let riskLevel;
            let scoreGradient;
            if (riskScore >= 75) {
                riskLevel = '높은 위험';
                scoreGradient = `conic-gradient(#ef4444 0%, #ef4444 ${riskScore}%, #1f2937 ${riskScore}%, #1f2937 100%)`;
                document.getElementById('riskLevel').style.color = '#ef4444';
            } else if (riskScore >= 50) {
                riskLevel = '중간 위험';
                scoreGradient = `conic-gradient(#f59e0b 0%, #f59e0b ${riskScore}%, #1f2937 ${riskScore}%, #1f2937 100%)`;
                document.getElementById('riskLevel').style.color = '#f59e0b';
            } else {
                riskLevel = '낮은 위험';
                scoreGradient = `conic-gradient(#10b981 0%, #10b981 ${riskScore}%, #1f2937 ${riskScore}%, #1f2937 100%)`;
                document.getElementById('riskLevel').style.color = '#10b981';
            }

            document.getElementById('riskLevel').textContent = riskLevel;
            document.querySelector('.score-circle').style.background = scoreGradient;
        }

        // 가상의 분석 결과 데이터 생성
        function generateMockAnalysisData(profile) {
            // 실제 구현에서는 서버에서 데이터를 가져와야 함
            console.log('가상 분석 데이터 생성됨:', profile.name);
        }

        // 시간 범위 변경 (일간/주간/월간)
        function changeActivityTimeframe(timeframe) {
            console.log('활동 시간 범위 변경:', timeframe);
            // 실제 구현에서는 차트 데이터 업데이트

            // 버튼 활성화 상태 변경
            const buttons = document.querySelectorAll('[onclick^="changeActivityTimeframe"]');
            buttons.forEach(btn => {
                btn.style.background = 'rgba(51, 65, 85, 0.5)';
            });

            event.target.style.background = 'rgba(99, 102, 241, 0.3)';
        }

        // 목록으로 돌아가기
        function goBackToList() {
            window.location.href = 'index.html';
        }

        // 보고서 내보내기
        function exportReport() {
            alert('분석 결과가 PDF 형식으로 다운로드됩니다. (구현 예정)');
            // 실제 구현에서는 PDF나 Excel로 내보내기
        }

        // 차트 로딩 시뮬레이션 (실제 구현에서는 Chart.js 등의 라이브러리 사용)
        function simulateChartLoading() {
            // 실제 구현에서는 이 부분에 차트 라이브러리 코드가 들어갑니다.
            const placeholders = document.querySelectorAll('.chart-placeholder');

            placeholders.forEach((placeholder, index) => {
                setTimeout(() => {
                    placeholder.innerHTML = '차트 데이터 표시됨';
                    placeholder.style.background = 'rgba(51, 65, 85, 0.3)';
                }, 1000 + index * 500);
            });
        }

        // 베이스라인 상세 정보 보기
        function showBaselineDetails() {
            alert('베이스라인 학습 세부 정보\n\n' +
                  '- 데이터 소스: ' + profileData.logSourceName + '\n' +
                  '- 학습 시작일: 2025-05-01\n' +
                  '- 학습 종료일: 2025-06-01\n' +
                  '- 이상 행동 임계값: ' + profileData.anomalyThreshold + '\n' +
                  '- 처리된 총 이벤트 수: 14,589개\n' +
                  '- 평균 일일 이벤트: 486개\n' +
                  '- 정상 행동 판단 신뢰도: 85%');
        }

        // 베이스라인 비교 토글
        function toggleBaselineComparison(showBaseline) {
            const behaviorChart = document.getElementById('behaviorPatternChart');
            const placeholder = behaviorChart.querySelector('.chart-placeholder');

            if (showBaseline) {
                placeholder.textContent = '베이스라인과 현재 행동을 비교하는 레이더 차트';
                placeholder.style.background = 'rgba(51, 65, 85, 0.3)';
            } else {
                placeholder.textContent = '현재 행동 패턴만 표시하는 레이더 차트';
                placeholder.style.background = 'rgba(30, 41, 59, 0.5)';
            }
        }

        // 베이스라인 정보 데이터 채우기
        function updateBaselineInfo() {
            if (profileData) {
                document.getElementById('learningDays').textContent = profileData.learningPeriod || '30';
                document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                }).replace(/\. /g, '-').replace('\.', '');

                // 선택한 메트릭에 대한 베이스라인 정보 생성
                generateBaselineMetrics();
            }
        }

        // 메트릭별 베이스라인 정보 생성
        function generateBaselineMetrics() {
            const container = document.getElementById('baselineMetricsContainer');
            container.innerHTML = '';

            // 선택된 메트릭이 없는 경우 메시지 표시
            if (!profileData.selectedMetrics || profileData.selectedMetrics.length === 0) {
                container.innerHTML = '<div style="padding: 1rem; text-align: center; color: #94a3b8;">선택된 분석 메트릭이 없습니다</div>';
                return;
            }

            // 메트릭 카테고리화 (시간/네트워크/접근)
            const categorizedMetrics = {
                time: ['로그인 시간 패턴', '세션 지속 시간', '업무시간 외 활동', '주말/휴일 접근', '로그인 빈도 변화', '동시 세션 탐지', '비활성 시간 패턴', '시간대 이상 접근'],
                network: ['IP 주소 패턴', '지리적 위치 분석', '데이터 전송량', '불가능한 이동 탐지', 'VPN 사용 패턴', '디바이스 변경 탐지', '대역폭 사용량 이상', '연결 패턴 분석', '프록시 우회 시도'],
                access: ['리소스 접근 패턴', '인증 실패 횟수', '권한 상승 시도', '민감 데이터 접근', '파일 다운로드 패턴', '관리자 권한 사용', '애플리케이션 사용 패턴', '데이터베이스 쿼리 패턴', '이메일 행동 패턴', '시스템 명령어 실행', '원격 접근 패턴', '공유 폴더 접근']
            };

            // 각 선택된 메트릭에 대해 베이스라인 정보 생성
            profileData.selectedMetrics.forEach(metric => {
                // 베이스라인 데이터 생성 (실제로는 서버에서 가져와야 함)
                const metricData = generateMockBaselineData(metric);

                // 메트릭 카테고리 결정
                let metricCategory = 'etc';
                for (const [category, metrics] of Object.entries(categorizedMetrics)) {
                    if (metrics.includes(metric)) {
                        metricCategory = category;
                        break;
                    }
                }

                // HTML 생성
                const metricHtml = `
                    <div class="baseline-metric-item">
                        <div class="baseline-metric-header">
                            <div class="baseline-metric-name">${metric} ${metricData.unit ? `(${metricData.unit})` : ''}</div>
                            <div class="baseline-deviation ${metricData.severityClass}">${metricData.deviation}</div>
                        </div>
                        <div class="baseline-comparison-bar">
                            <div class="baseline-normal-range" style="left: ${metricData.rangeStart}%; right: ${metricData.rangeEnd}%;">
                                <span class="baseline-min">${metricData.min}</span>
                                <span class="baseline-max">${metricData.max}</span>
                            </div>
                            <div class="baseline-current-value" style="left: ${metricData.currentPosition}%;">${metricData.current}</div>
                        </div>
                    </div>
                `;

                container.innerHTML += metricHtml;
            });
        }

        // 메트릭별 가상 베이스라인 데이터 생성
        function generateMockBaselineData(metric) {
            // 메트릭별 특성에 맞게 가상 데이터 생성 (실제로는 서버에서 가져와야 함)
            const data = {};

            // 1. 시간 관련 메트릭
            if (metric.includes('시간') || metric.includes('세션') || metric.includes('빈도')) {
                if (metric.includes('로그인 시간')) {
                    data.min = '08:30';
                    data.max = '18:00';
                    data.current = '23:15';
                    data.deviation = '+47%';
                    data.severityClass = 'high';
                } else if (metric.includes('세션 지속 시간')) {
                    data.min = '45분';
                    data.max = '3시간';
                    data.current = '5시간';
                    data.deviation = '+67%';
                    data.severityClass = 'medium';
                    data.unit = '평균';
                } else if (metric.includes('업무시간 외 활동')) {
                    data.min = '3%';
                    data.max = '7%';
                    data.current = '12%';
                    data.deviation = '+5%';
                    data.severityClass = 'low';
                } else if (metric.includes('주말/휴일 접근')) {
                    data.min = '0';
                    data.max = '2';
                    data.current = '5';
                    data.deviation = '+150%';
                    data.severityClass = 'medium';
                    data.unit = '주간';
                } else if (metric.includes('로그인 빈도')) {
                    data.min = '3';
                    data.max = '8';
                    data.current = '12';
                    data.deviation = '+50%';
                    data.severityClass = 'medium';
                    data.unit = '일간';
                } else {
                    data.min = '0';
                    data.max = '2';
                    data.current = '3';
                    data.deviation = '+50%';
                    data.severityClass = 'low';
                }
            }
            // 2. 네트워크 관련 메트릭
            else if (metric.includes('IP') || metric.includes('데이터') || metric.includes('전송') || metric.includes('대역폭') || metric.includes('연결') || metric.includes('VPN') || metric.includes('지리적')) {
                if (metric.includes('IP 주소 패턴')) {
                    data.min = '1';
                    data.max = '2';
                    data.current = '3';
                    data.deviation = '+50%';
                    data.severityClass = 'medium';
                    data.unit = '주간 변경';
                } else if (metric.includes('데이터 전송량')) {
                    data.min = '50MB';
                    data.max = '170MB';
                    data.current = '367MB';
                    data.deviation = '+215%';
                    data.severityClass = 'medium';
                    data.unit = '일간';
                } else if (metric.includes('대역폭 사용량')) {
                    data.min = '5MB/s';
                    data.max = '20MB/s';
                    data.current = '35MB/s';
                    data.deviation = '+75%';
                    data.severityClass = 'high';
                } else if (metric.includes('지리적 위치')) {
                    data.min = '1';
                    data.max = '1';
                    data.current = '3';
                    data.deviation = 'Unusual';
                    data.severityClass = 'high';
                    data.unit = '위치 수';
                } else {
                    data.min = '10';
                    data.max = '30';
                    data.current = '45';
                    data.deviation = '+50%';
                    data.severityClass = 'medium';
                }
            }
            // 3. 접근 관련 메트릭
            else if (metric.includes('접근') || metric.includes('권한') || metric.includes('인증') || metric.includes('다운로드') || metric.includes('명령어') || metric.includes('민감') || metric.includes('쿼리')) {
                if (metric.includes('인증 실패')) {
                    data.min = '0';
                    data.max = '3';
                    data.current = '2';
                    data.deviation = 'Normal';
                    data.severityClass = 'low';
                    data.unit = '일간';
                } else if (metric.includes('권한 상승 시도')) {
                    data.min = '0';
                    data.max = '0';
                    data.current = '1';
                    data.deviation = 'Rare';
                    data.severityClass = 'high';
                    data.unit = '월간';
                } else if (metric.includes('파일 다운로드')) {
                    data.min = '5';
                    data.max = '20';
                    data.current = '47';
                    data.deviation = '+135%';
                    data.severityClass = 'high';
                    data.unit = '일간';
                } else if (metric.includes('민감 데이터')) {
                    data.min = '0';
                    data.max = '5';
                    data.current = '12';
                    data.deviation = '+140%';
                    data.severityClass = 'high';
                    data.unit = '주간 접근';
                } else {
                    data.min = '0';
                    data.max = '10';
                    data.current = '8';
                    data.deviation = 'Normal';
                    data.severityClass = 'low';
                }
            }
            // 4. 기타 메트릭
            else {
                data.min = '10';
                data.max = '50';
                data.current = '45';
                data.deviation = 'Normal';
                data.severityClass = 'low';
            }

            // 그래프 위치값 계산 (백분율)
            data.rangeStart = Math.floor(Math.random() * 30) + 5; // 5-35%
            data.rangeEnd = Math.floor(Math.random() * 30) + 30; // 30-60%
            data.currentPosition = (data.severityClass === 'low')
                ? Math.floor(Math.random() * 20) + data.rangeStart + 5 // 정상 범위 근처
                : Math.floor(Math.random() * 30) + 60; // 범위 벗어남

            return data;
        }
    </script>
</body>
</html>
