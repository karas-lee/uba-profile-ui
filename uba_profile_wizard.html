<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBA í”„ë¡œíŒŒì¼ ë§ˆë²•ì‚¬</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a2332 100%);
            color: #e2e8f0;
            min-height: 100vh;
        }

        .wizard-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: #94a3b8;
            font-size: 1.1rem;
        }

        .progress-bar {
            display: flex;
            justify-content: center;
            margin-bottom: 3rem;
            gap: 1rem;
        }

        .progress-step {
            display: flex;
            align-items: center;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .step-circle.active {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.4);
        }

        .step-circle.completed {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .step-circle.inactive {
            background: #374151;
            color: #9ca3af;
        }

        .step-label {
            margin-left: 0.75rem;
            font-size: 0.9rem;
            color: #94a3b8;
        }

        .wizard-content {
            flex: 1;
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(51, 65, 85, 0.3);
            border-radius: 1rem;
            padding: 2.5rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .step-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .step-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #f1f5f9;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(51, 65, 85, 0.5);
            border-radius: 0.5rem;
            color: #e2e8f0;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .radio-item {
            display: flex;
            align-items: flex-start;
            padding: 1.25rem;
            background: rgba(15, 23, 42, 0.6);
            border: 2px solid rgba(51, 65, 85, 0.3);
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .radio-item:hover {
            background: rgba(15, 23, 42, 0.8);
            border-color: #6366f1;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.15);
        }

        .radio-item.selected {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(139, 92, 246, 0.15));
            border-color: #6366f1;
            box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.3);
        }

        .radio-item input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-right: 1rem;
            margin-top: 0.25rem;
            accent-color: #6366f1;
            cursor: pointer;
        }

        .radio-item label {
            cursor: pointer;
            line-height: 1.4;
            flex: 1;
        }

        .radio-item label strong {
            display: block;
            color: #f1f5f9;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .radio-description {
            display: block;
            color: #94a3b8;
            font-size: 0.9rem;
            font-weight: normal;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(51, 65, 85, 0.3);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-item:hover {
            background: rgba(15, 23, 42, 0.8);
            border-color: #6366f1;
            transform: translateY(-2px);
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin-right: 0.75rem;
            accent-color: #6366f1;
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.1);
        }

        .metric-card h4 {
            color: #6366f1;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .metric-card p {
            color: #94a3b8;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .metric-card.disabled {
            opacity: 0.4;
            pointer-events: none;
            background: rgba(15, 23, 42, 0.3);
            border-color: rgba(51, 65, 85, 0.2);
        }

        .metric-card.disabled h4 {
            color: #64748b;
        }

        .metric-unavailable {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
            padding: 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(51, 65, 85, 0.3);
        }

        .btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #5856eb, #7c3aed);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: rgba(51, 65, 85, 0.7);
            color: #e2e8f0;
            border: 1px solid rgba(51, 65, 85, 0.5);
        }

        .btn-secondary:hover:not(:disabled) {
            background: rgba(51, 65, 85, 0.9);
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid;
        }

        .alert-info {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
            color: #93c5fd;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .summary-card {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(51, 65, 85, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
        }

        .summary-card h4 {
            color: #f1f5f9;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(51, 65, 85, 0.2);
        }

        .summary-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .tag {
            display: inline-block;
            background: rgba(99, 102, 241, 0.2);
            color: #a5b4fc;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            margin: 0.125rem;
        }

        .select-all-btn {
            display: flex;
            align-items: center;
            background: rgba(99, 102, 241, 0.15);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: #a5b4fc;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .select-all-btn:hover {
            background: rgba(99, 102, 241, 0.25);
            transform: translateY(-1px);
        }

        .select-all-btn input[type="checkbox"] {
            accent-color: #6366f1;
        }

        .selected-count {
            font-size: 0.85rem;
            color: #94a3b8;
            background: rgba(15, 23, 42, 0.6);
            padding: 0.3rem 0.8rem;
            border-radius: 0.5rem;
        }

        @media (max-width: 768px) {
            .wizard-container { padding: 1rem; }
            .progress-bar { flex-direction: column; align-items: center; gap: 1rem; }
            .button-group { flex-direction: column; gap: 1rem; }
        }
    </style>
</head>
<body>
    <div class="wizard-container">
        <div class="header">
            <h1>UBA í”„ë¡œíŒŒì¼ ë§ˆë²•ì‚¬</h1>
            <p>ì‚¬ìš©ì ë° ì—”í„°í‹° í–‰ë™ ë¶„ì„ í”„ë¡œíŒŒì¼ì„ ì‰½ê²Œ ì„¤ì •í•˜ì„¸ìš”</p>
        </div>

        <div class="progress-bar">
            <div class="progress-step">
                <div class="step-circle active" id="step1">1</div>
                <div class="step-label">ê¸°ë³¸ ì •ë³´</div>
            </div>
            <div class="progress-step">
                <div class="step-circle inactive" id="step2">2</div>
                <div class="step-label">ë°ì´í„° ì†ŒìŠ¤</div>
            </div>
            <div class="progress-step">
                <div class="step-circle inactive" id="step3">3</div>
                <div class="step-label">ë¶„ì„ ë©”íŠ¸ë¦­</div>
            </div>
            <div class="progress-step">
                <div class="step-circle inactive" id="step4">4</div>
                <div class="step-label">ì„ê³„ê°’ ì„¤ì •</div>
            </div>
            <div class="progress-step">
                <div class="step-circle inactive" id="step5">5</div>
                <div class="step-label">ê²€í†  ë° ì™„ë£Œ</div>
            </div>
        </div>

        <div class="wizard-content">
            <!-- Step 1: ê¸°ë³¸ ì •ë³´ -->
            <div class="step-content active" id="content1">
                <h3 style="margin-bottom: 2rem; color: #f1f5f9; font-size: 1.5rem;">UBA í”„ë¡œíŒŒì¼ ê¸°ë³¸ ì •ë³´</h3>

                <div class="form-group">
                    <label for="profileName">í”„ë¡œíŒŒì¼ ì´ë¦„ *</label>
                    <input type="text" id="profileName" placeholder="ì˜ˆ: ì¼ë°˜ ì‚¬ìš©ì í–‰ë™ í”„ë¡œíŒŒì¼">
                </div>

                <div class="form-group">
                    <label for="profileDescription">ì„¤ëª…</label>
                    <textarea id="profileDescription" rows="3" placeholder="ì´ í”„ë¡œíŒŒì¼ì´ ë¶„ì„í•˜ëŠ” í–‰ë™ íŒ¨í„´ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label for="profileType">í”„ë¡œíŒŒì¼ ìœ í˜•</label>
                        <select id="profileType">
                            <option value="user">ì‚¬ìš©ì í”„ë¡œíŒŒì¼</option>
                            <option value="entity">ì—”í„°í‹° í”„ë¡œíŒŒì¼</option>
                            <option value="hybrid">í•˜ì´ë¸Œë¦¬ë“œ í”„ë¡œíŒŒì¼</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="analysisScope">ë¶„ì„ ë²”ìœ„</label>
                        <select id="analysisScope">
                            <option value="department">ë¶€ì„œë³„</option>
                            <option value="role">ì—­í• ë³„</option>
                            <option value="global">ì „ì²´ ì¡°ì§</option>
                            <option value="custom">ì‚¬ìš©ì ì •ì˜</option>
                        </select>
                    </div>
                </div>

                <div class="alert alert-info">
                    <strong>ì •ë³´:</strong> UBA í”„ë¡œíŒŒì¼ì€ ì •ìƒì ì¸ ì‚¬ìš©ì í–‰ë™ íŒ¨í„´ì„ í•™ìŠµí•˜ì—¬ ì´ìƒ ì§•í›„ë¥¼ íƒì§€í•©ë‹ˆë‹¤.
                </div>
            </div>

            <!-- Step 2: ë°ì´í„° ì†ŒìŠ¤ -->
            <div class="step-content" id="content2">
                <h3 style="margin-bottom: 2rem; color: #f1f5f9; font-size: 1.5rem;">ë°ì´í„° ì†ŒìŠ¤ ì„ íƒ</h3>

                <div class="form-group">
                    <label>ë¡œê·¸ ì†ŒìŠ¤ ì„ íƒ * (í•˜ë‚˜ë§Œ ì„ íƒ)</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="windowsLogs" name="logSource" value="windows">
                            <label for="windowsLogs">
                                <strong>Windows ì´ë²¤íŠ¸ ë¡œê·¸</strong>
                                <span class="radio-description">ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ, ì‹œìŠ¤í…œ ì´ë²¤íŠ¸</span>
                            </label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="adLogs" name="logSource" value="ad">
                            <label for="adLogs">
                                <strong>Active Directory</strong>
                                <span class="radio-description">ì‚¬ìš©ì ì¸ì¦, ê¶Œí•œ ë³€ê²½, ê·¸ë£¹ ê´€ë¦¬</span>
                            </label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="firewallLogs" name="logSource" value="firewall">
                            <label for="firewallLogs">
                                <strong>ë°©í™”ë²½ ë¡œê·¸</strong>
                                <span class="radio-description">ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½, IP ì ‘ê·¼ íŒ¨í„´</span>
                            </label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="proxyLogs" name="logSource" value="proxy">
                            <label for="proxyLogs">
                                <strong>í”„ë¡ì‹œ/ì›¹ ë¡œê·¸</strong>
                                <span class="radio-description">ì›¹ ì‚¬ì´íŠ¸ ì ‘ê·¼, URL íŒ¨í„´</span>
                            </label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="vpnLogs" name="logSource" value="vpn">
                            <label for="vpnLogs">
                                <strong>VPN ë¡œê·¸</strong>
                                <span class="radio-description">ì›ê²© ì ‘ì†, ì§€ì—­ë³„ ì—°ê²° íŒ¨í„´</span>
                            </label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="dnsLogs" name="logSource" value="dns">
                            <label for="dnsLogs">
                                <strong>DNS ë¡œê·¸</strong>
                                <span class="radio-description">ë„ë©”ì¸ ìš”ì²­, DNS ì¿¼ë¦¬ íŒ¨í„´</span>
                            </label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="emailLogs" name="logSource" value="email">
                            <label for="emailLogs">
                                <strong>ì´ë©”ì¼ ë¡œê·¸</strong>
                                <span class="radio-description">ì´ë©”ì¼ ì†¡ìˆ˜ì‹ , ì²¨ë¶€íŒŒì¼ íŒ¨í„´</span>
                            </label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="dbLogs" name="logSource" value="database">
                            <label for="dbLogs">
                                <strong>ë°ì´í„°ë² ì´ìŠ¤ ë¡œê·¸</strong>
                                <span class="radio-description">ë°ì´í„° ì ‘ê·¼, ì¿¼ë¦¬ ì‹¤í–‰ íŒ¨í„´</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="learningPeriod">í•™ìŠµ ê¸°ê°„</label>
                    <select id="learningPeriod">
                        <option value="7">7ì¼</option>
                        <option value="14">14ì¼</option>
                        <option value="30" selected>30ì¼</option>
                        <option value="60">60ì¼</option>
                        <option value="90">90ì¼</option>
                    </select>
                </div>

                <div class="alert alert-info">
                    <strong>ê¶Œì¥ì‚¬í•­:</strong> ì •í™•í•œ ë² ì´ìŠ¤ë¼ì¸ ì„¤ì •ì„ ìœ„í•´ ìµœì†Œ 30ì¼ê°„ì˜ í•™ìŠµ ê¸°ê°„ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
                </div>
            </div>

            <!-- Step 3: ë¶„ì„ ë©”íŠ¸ë¦­ -->
            <div class="step-content" id="content3">
                <h3 style="margin-bottom: 2rem; color: #f1f5f9; font-size: 1.5rem;">ë¶„ì„ ë©”íŠ¸ë¦­ ì„¤ì •</h3>

                <div id="selectedLogInfo" class="alert alert-info" style="display: none;">
                    <strong>ì„ íƒëœ ë¡œê·¸ ì†ŒìŠ¤:</strong> <span id="logSourceName">-</span><br>
                    <strong>ë¶„ì„ ê°€ëŠ¥í•œ ë©”íŠ¸ë¦­:</strong> <span id="availableMetrics">-</span>
                </div>

                <div class="metric-card" id="timeMetricCard">
                    <h4>ğŸ“… ì‹œê°„ ê¸°ë°˜ ë¶„ì„</h4>
                    <p>ì‚¬ìš©ìì˜ ì‹œê°„ì  í–‰ë™ íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬ ì´ìƒ ì§•í›„ë¥¼ íƒì§€í•©ë‹ˆë‹¤.</p>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin: 0.75rem 0;">
                        <button type="button" id="selectAllTimeBtn" class="select-all-btn">
                            <span>ì „ì²´ ì„ íƒ</span>
                            <input type="checkbox" id="selectAllTime" style="margin-left: 8px;">
                        </button>
                        <span id="timeSelectedCount" class="selected-count">0ê°œ ì„ íƒë¨</span>
                    </div>
                    <div class="checkbox-group" style="margin-top: 1rem;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="loginTime" value="login_time">
                            <label for="loginTime">ë¡œê·¸ì¸ ì‹œê°„ íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sessionDuration" value="session_duration">
                            <label for="sessionDuration">ì„¸ì…˜ ì§€ì† ì‹œê°„</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="afterHours" value="after_hours">
                            <label for="afterHours">ì—…ë¬´ì‹œê°„ ì™¸ í™œë™</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="weekendActivity" value="weekend_activity">
                            <label for="weekendActivity">ì£¼ë§/íœ´ì¼ ì ‘ê·¼</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="loginFrequency" value="login_frequency">
                            <label for="loginFrequency">ë¡œê·¸ì¸ ë¹ˆë„ ë³€í™”</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sessionOverlap" value="session_overlap">
                            <label for="sessionOverlap">ë™ì‹œ ì„¸ì…˜ íƒì§€</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="idleTime" value="idle_time">
                            <label for="idleTime">ë¹„í™œì„± ì‹œê°„ íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="timeZoneAnomaly" value="timezone_anomaly">
                            <label for="timeZoneAnomaly">ì‹œê°„ëŒ€ ì´ìƒ ì ‘ê·¼</label>
                        </div>
                    </div>
                    <div id="timeMetricUnavailable" class="metric-unavailable" style="display: none;">
                        ì´ ë¡œê·¸ ì†ŒìŠ¤ì—ì„œëŠ” ì‹œê°„ ê¸°ë°˜ ë¶„ì„ì´ ì œí•œì ì´ê±°ë‚˜ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                    </div>
                </div>

                <div class="metric-card" id="networkMetricCard">
                    <h4>ğŸŒ ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ ë¶„ì„</h4>
                    <p>ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ íŒ¨í„´ê³¼ ì§€ë¦¬ì  ìœ„ì¹˜ë¥¼ ë¶„ì„í•˜ì—¬ ì´ìƒ ì§•í›„ë¥¼ íƒì§€í•©ë‹ˆë‹¤.</p>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin: 0.75rem 0;">
                        <button type="button" id="selectAllNetworkBtn" class="select-all-btn">
                            <span>ì „ì²´ ì„ íƒ</span>
                            <input type="checkbox" id="selectAllNetwork" style="margin-left: 8px;">
                        </button>
                        <span id="networkSelectedCount" class="selected-count">0ê°œ ì„ íƒë¨</span>
                    </div>
                    <div class="checkbox-group" style="margin-top: 1rem;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="ipAddress" value="ip_address">
                            <label for="ipAddress">IP ì£¼ì†Œ íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="geoLocation" value="geo_location">
                            <label for="geoLocation">ì§€ë¦¬ì  ìœ„ì¹˜ ë¶„ì„</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="dataVolume" value="data_volume">
                            <label for="dataVolume">ë°ì´í„° ì „ì†¡ëŸ‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="impossibleTravel" value="impossible_travel">
                            <label for="impossibleTravel">ë¶ˆê°€ëŠ¥í•œ ì´ë™ íƒì§€</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="vpnUsage" value="vpn_usage">
                            <label for="vpnUsage">VPN ì‚¬ìš© íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="networkDevice" value="network_device">
                            <label for="networkDevice">ë””ë°”ì´ìŠ¤ ë³€ê²½ íƒì§€</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="bandwidthUsage" value="bandwidth_usage">
                            <label for="bandwidthUsage">ëŒ€ì—­í­ ì‚¬ìš©ëŸ‰ ì´ìƒ</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="connectionPattern" value="connection_pattern">
                            <label for="connectionPattern">ì—°ê²° íŒ¨í„´ ë¶„ì„</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="proxyBypass" value="proxy_bypass">
                            <label for="proxyBypass">í”„ë¡ì‹œ ìš°íšŒ ì‹œë„</label>
                        </div>
                    </div>
                    <div id="networkMetricUnavailable" class="metric-unavailable" style="display: none;">
                        ì´ ë¡œê·¸ ì†ŒìŠ¤ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ ë¶„ì„ì´ ì œí•œì ì´ê±°ë‚˜ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                    </div>
                </div>

                <div class="metric-card" id="accessMetricCard">
                    <h4>ğŸ” ì ‘ê·¼ ê¸°ë°˜ ë¶„ì„</h4>
                    <p>ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ íŒ¨í„´ê³¼ ê¶Œí•œ ì‚¬ìš©ì„ ë¶„ì„í•˜ì—¬ ì´ìƒ ì§•í›„ë¥¼ íƒì§€í•©ë‹ˆë‹¤.</p>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin: 0.75rem 0;">
                        <button type="button" id="selectAllAccessBtn" class="select-all-btn">
                            <span>ì „ì²´ ì„ íƒ</span>
                            <input type="checkbox" id="selectAllAccess" style="margin-left: 8px;">
                        </button>
                        <span id="accessSelectedCount" class="selected-count">0ê°œ ì„ íƒë¨</span>
                    </div>
                    <div class="checkbox-group" style="margin-top: 1rem;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="resourceAccess" value="resource_access">
                            <label for="resourceAccess">ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="authFailures" value="auth_failures">
                            <label for="authFailures">ì¸ì¦ ì‹¤íŒ¨ íšŸìˆ˜</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="privilegeEscalation" value="privilege_escalation">
                            <label for="privilegeEscalation">ê¶Œí•œ ìƒìŠ¹ ì‹œë„</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sensitiveDataAccess" value="sensitive_data">
                            <label for="sensitiveDataAccess">ë¯¼ê° ë°ì´í„° ì ‘ê·¼</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="fileDownload" value="file_download">
                            <label for="fileDownload">íŒŒì¼ ë‹¤ìš´ë¡œë“œ íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="adminAccess" value="admin_access">
                            <label for="adminAccess">ê´€ë¦¬ì ê¶Œí•œ ì‚¬ìš©</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="applicationUsage" value="app_usage">
                            <label for="applicationUsage">ì• í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ìš© íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="databaseQuery" value="db_query">
                            <label for="databaseQuery">ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="emailBehavior" value="email_behavior">
                            <label for="emailBehavior">ì´ë©”ì¼ í–‰ë™ íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="systemCommand" value="system_command">
                            <label for="systemCommand">ì‹œìŠ¤í…œ ëª…ë ¹ì–´ ì‹¤í–‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="remoteAccess" value="remote_access">
                            <label for="remoteAccess">ì›ê²© ì ‘ê·¼ íŒ¨í„´</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="shareAccess" value="share_access">
                            <label for="shareAccess">ê³µìœ  í´ë” ì ‘ê·¼</label>
                        </div>
                    </div>
                    <div id="accessMetricUnavailable" class="metric-unavailable" style="display: none;">
                        ì´ ë¡œê·¸ ì†ŒìŠ¤ì—ì„œëŠ” ì ‘ê·¼ ê¸°ë°˜ ë¶„ì„ì´ ì œí•œì ì´ê±°ë‚˜ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                    </div>
                </div>
            </div>

            <!-- Step 4: ì„ê³„ê°’ ì„¤ì • -->
            <div class="step-content" id="content4">
                <h3 style="margin-bottom: 2rem; color: #f1f5f9; font-size: 1.5rem;">ì´ìƒ ì§•í›„ ì„ê³„ê°’ ì„¤ì •</h3>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div class="form-group">
                        <label for="anomalyThreshold">ì´ìƒ ì§•í›„ ë¯¼ê°ë„</label>
                        <select id="anomalyThreshold">
                            <option value="low">ë‚®ìŒ (ë³´ìˆ˜ì )</option>
                            <option value="medium" selected>ë³´í†µ (ê¶Œì¥)</option>
                            <option value="high">ë†’ìŒ (ë¯¼ê°í•¨)</option>
                            <option value="custom">ì‚¬ìš©ì ì •ì˜</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="alertSeverity">ê²½ê³  ì‹¬ê°ë„</label>
                        <select id="alertSeverity">
                            <option value="info">ì •ë³´</option>
                            <option value="low">ë‚®ìŒ</option>
                            <option value="medium" selected>ë³´í†µ</option>
                            <option value="high">ë†’ìŒ</option>
                            <option value="critical">ë§¤ìš° ë†’ìŒ</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="riskScore">ìœ„í—˜ ì ìˆ˜ ì„ê³„ê°’ (0-100)</label>
                    <input type="range" id="riskScore" min="0" max="100" value="70" style="width: 100%;">
                    <div style="display: flex; justify-content: space-between; margin-top: 0.5rem; font-size: 0.9rem; color: #94a3b8;">
                        <span>0 (ë‚®ìŒ)</span>
                        <span id="riskScoreValue">70</span>
                        <span>100 (ë†’ìŒ)</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ì•Œë¦¼ ì„¤ì •</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="emailAlert" value="email" checked>
                            <label for="emailAlert">ì´ë©”ì¼ ì•Œë¦¼</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="slackAlert" value="slack">
                            <label for="slackAlert">Slack ì•Œë¦¼</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="smsAlert" value="sms">
                            <label for="smsAlert">SMS ì•Œë¦¼</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="dashboardAlert" value="dashboard" checked>
                            <label for="dashboardAlert">ëŒ€ì‹œë³´ë“œ í‘œì‹œ</label>
                        </div>
                    </div>
                </div>

                <div class="alert alert-info">
                    <strong>ì°¸ê³ :</strong> ì„ê³„ê°’ì´ ë‚®ì„ìˆ˜ë¡ ë” ë§ì€ ì´ìƒ ì§•í›„ë¥¼ íƒì§€í•˜ì§€ë§Œ, ì˜¤íƒë¥ ë„ ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>
            </div>

            <!-- Step 5: ê²€í†  ë° ì™„ë£Œ -->
            <div class="step-content" id="content5">
                <h3 style="margin-bottom: 2rem; color: #f1f5f9; font-size: 1.5rem;">ì„¤ì • ê²€í†  ë° ì™„ë£Œ</h3>

                <div class="summary-grid">
                    <div class="summary-card">
                        <h4>ğŸ“‹ ê¸°ë³¸ ì •ë³´</h4>
                        <div class="summary-item">
                            <span>í”„ë¡œíŒŒì¼ ì´ë¦„:</span>
                            <span id="summaryName">-</span>
                        </div>
                        <div class="summary-item">
                            <span>í”„ë¡œíŒŒì¼ ìœ í˜•:</span>
                            <span id="summaryType">-</span>
                        </div>
                        <div class="summary-item">
                            <span>ë¶„ì„ ë²”ìœ„:</span>
                            <span id="summaryScope">-</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <h4>ğŸ“Š ë°ì´í„° ì†ŒìŠ¤</h4>
                        <div class="summary-item">
                            <span>í•™ìŠµ ê¸°ê°„:</span>
                            <span id="summaryLearning">-</span>
                        </div>
                        <div style="margin-top: 1rem;">
                            <div id="summaryDataSources">ì„ íƒëœ ì†ŒìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <h4>ğŸ“ˆ ë¶„ì„ ë©”íŠ¸ë¦­</h4>
                        <div id="summaryMetrics">ì„ íƒëœ ë©”íŠ¸ë¦­ì´ ì—†ìŠµë‹ˆë‹¤</div>
                    </div>

                    <div class="summary-card">
                        <h4>âš ï¸ ì•Œë¦¼ ì„¤ì •</h4>
                        <div class="summary-item">
                            <span>ë¯¼ê°ë„:</span>
                            <span id="summarySensitivity">-</span>
                        </div>
                        <div class="summary-item">
                            <span>ìœ„í—˜ ì ìˆ˜ ì„ê³„ê°’:</span>
                            <span id="summaryRiskScore">-</span>
                        </div>
                        <div style="margin-top: 1rem;">
                            <div id="summaryAlerts">ì•Œë¦¼ ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤</div>
                        </div>
                    </div>
                </div>

                <div class="alert alert-info">
                    <strong>ë‹¤ìŒ ë‹¨ê³„:</strong> í”„ë¡œíŒŒì¼ ìƒì„± í›„ ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ í•™ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤. ì´ˆê¸° ë² ì´ìŠ¤ë¼ì¸ ì„¤ì •ê¹Œì§€ ì•½ 24-48ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>
            </div>
        </div>

        <div class="button-group">
            <button class="btn btn-secondary" id="prevBtn" onclick="prevStep()" disabled>
                â† ì´ì „
            </button>
            <button class="btn btn-primary" id="nextBtn" onclick="nextStep()">
                ë‹¤ìŒ â†’
            </button>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 5;

        // ì „ì²´ ì„ íƒ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.getElementById('selectAllTimeBtn').addEventListener('click', function() {
            const checkbox = document.getElementById('selectAllTime');
            checkbox.checked = !checkbox.checked;

            // ëª¨ë“  í™œì„±í™”ëœ ì‹œê°„ ê¸°ë°˜ ì²´í¬ë°•ìŠ¤ì— ì ìš©
            const timeCheckboxes = document.querySelectorAll('#timeMetricCard input[type="checkbox"]:not(#selectAllTime):not(:disabled)');
            timeCheckboxes.forEach(cb => {
                cb.checked = checkbox.checked;
            });

            updateSelectedCount('time');
        });

        document.getElementById('selectAllNetworkBtn').addEventListener('click', function() {
            const checkbox = document.getElementById('selectAllNetwork');
            checkbox.checked = !checkbox.checked;

            // ëª¨ë“  í™œì„±í™”ëœ ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ ì²´í¬ë°•ìŠ¤ì— ì ìš©
            const networkCheckboxes = document.querySelectorAll('#networkMetricCard input[type="checkbox"]:not(#selectAllNetwork):not(:disabled)');
            networkCheckboxes.forEach(cb => {
                cb.checked = checkbox.checked;
            });

            updateSelectedCount('network');
        });

        document.getElementById('selectAllAccessBtn').addEventListener('click', function() {
            const checkbox = document.getElementById('selectAllAccess');
            checkbox.checked = !checkbox.checked;

            // ëª¨ë“  í™œì„±í™”ëœ ì ‘ê·¼ ê¸°ë°˜ ì²´í¬ë°•ìŠ¤ì— ì ìš©
            const accessCheckboxes = document.querySelectorAll('#accessMetricCard input[type="checkbox"]:not(#selectAllAccess):not(:disabled)');
            accessCheckboxes.forEach(cb => {
                cb.checked = checkbox.checked;
            });

            updateSelectedCount('access');
        });

        // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ì—ë„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.getElementById('selectAllTime').addEventListener('change', function() {
            const timeCheckboxes = document.querySelectorAll('#timeMetricCard input[type="checkbox"]:not(#selectAllTime):not(:disabled)');
            timeCheckboxes.forEach(cb => {
                cb.checked = this.checked;
            });

            updateSelectedCount('time');
        });

        document.getElementById('selectAllNetwork').addEventListener('change', function() {
            const networkCheckboxes = document.querySelectorAll('#networkMetricCard input[type="checkbox"]:not(#selectAllNetwork):not(:disabled)');
            networkCheckboxes.forEach(cb => {
                cb.checked = this.checked;
            });

            updateSelectedCount('network');
        });

        document.getElementById('selectAllAccess').addEventListener('change', function() {
            const accessCheckboxes = document.querySelectorAll('#accessMetricCard input[type="checkbox"]:not(#selectAllAccess):not(:disabled)');
            accessCheckboxes.forEach(cb => {
                cb.checked = this.checked;
            });

            updateSelectedCount('access');
        });

        // ì²´í¬ë°•ìŠ¤ ìƒíƒœì— ë”°ë¼ ì„ íƒëœ í•­ëª© ìˆ˜ ì—…ë°ì´íŠ¸
        function updateSelectedCount(type) {
            const cardId = type + 'MetricCard';
            const counterId = type + 'SelectedCount';
            const checkboxes = document.querySelectorAll(`#${cardId} input[type="checkbox"]:not(#selectAll${type.charAt(0).toUpperCase() + type.slice(1)}):not(:disabled):checked`);
            document.getElementById(counterId).textContent = `${checkboxes.length}ê°œ ì„ íƒë¨`;
        }

        // ê°œë³„ ì²´í¬ë°•ìŠ¤ ìƒíƒœì— ë”°ë¼ ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateSelectAllCheckbox(categoryId, selectAllId) {
            const checkboxes = document.querySelectorAll(`#${categoryId} input[type="checkbox"]:not(#${selectAllId}):not(:disabled)`);
            const selectAllCheckbox = document.getElementById(selectAllId);

            const allChecked = Array.from(checkboxes).every(checkbox => checkbox.checked);
            const someChecked = Array.from(checkboxes).some(checkbox => checkbox.checked);

            selectAllCheckbox.checked = allChecked;
            selectAllCheckbox.indeterminate = someChecked && !allChecked;

            // ì„ íƒëœ í•­ëª© ìˆ˜ ì—…ë°ì´íŠ¸
            const type = categoryId.replace('MetricCard', '');
            updateSelectedCount(type);
        }

        // ê°œë³„ ì²´í¬ë°•ìŠ¤ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.querySelectorAll('#timeMetricCard input[type="checkbox"]:not(#selectAllTime)').forEach(checkbox => {
            checkbox.addEventListener('change', () => updateSelectAllCheckbox('timeMetricCard', 'selectAllTime'));
        });

        document.querySelectorAll('#networkMetricCard input[type="checkbox"]:not(#selectAllNetwork)').forEach(checkbox => {
            checkbox.addEventListener('change', () => updateSelectAllCheckbox('networkMetricCard', 'selectAllNetwork'));
        });

        document.querySelectorAll('#accessMetricCard input[type="checkbox"]:not(#selectAllAccess)').forEach(checkbox => {
            checkbox.addEventListener('change', () => updateSelectAllCheckbox('accessMetricCard', 'selectAllAccess'));
        });

        // ë¡œê·¸ ì†ŒìŠ¤ë³„ ë©”íŠ¸ë¦­ ê°€ìš©ì„± ë§¤íŠ¸ë¦­ìŠ¤ (í™•ì¥ëœ ë©”íŠ¸ë¦­)
        const logSourceMetrics = {
            'windows': {
                'name': 'Windows ì´ë²¤íŠ¸ ë¡œê·¸',
                'time_based': {
                    'available': true,
                    'metrics': ['login_time', 'session_duration', 'after_hours', 'weekend_activity', 'login_frequency', 'session_overlap', 'idle_time']
                },
                'network_based': {
                    'available': false,
                    'metrics': [],
                    'reason': 'Windows ì´ë²¤íŠ¸ ë¡œê·¸ëŠ” ë„¤íŠ¸ì›Œí¬ ì •ë³´ë¥¼ í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'
                },
                'access_based': {
                    'available': true,
                    'metrics': ['resource_access', 'auth_failures', 'privilege_escalation', 'admin_access', 'app_usage', 'system_command', 'remote_access']
                }
            },
            'ad': {
                'name': 'Active Directory',
                'time_based': {
                    'available': true,
                    'metrics': ['login_time', 'session_duration', 'after_hours', 'weekend_activity', 'login_frequency', 'session_overlap']
                },
                'network_based': {
                    'available': false,
                    'metrics': [],
                    'reason': 'Active DirectoryëŠ” ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'
                },
                'access_based': {
                    'available': true,
                    'metrics': ['resource_access', 'auth_failures', 'privilege_escalation', 'admin_access', 'app_usage', 'system_command', 'remote_access']
                }
            },
            'firewall': {
                'name': 'ë°©í™”ë²½ ë¡œê·¸',
                'time_based': {
                    'available': true,
                    'metrics': ['login_time', 'after_hours', 'weekend_activity', 'timezone_anomaly']
                },
                'network_based': {
                    'available': true,
                    'metrics': ['ip_address', 'geo_location', 'data_volume', 'impossible_travel', 'network_device', 'bandwidth_usage', 'connection_pattern']
                },
                'access_based': {
                    'available': false,
                    'metrics': [],
                    'reason': 'ë°©í™”ë²½ ë¡œê·¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ì¤€ì˜ ì ‘ê·¼ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'
                }
            },
            'proxy': {
                'name': 'í”„ë¡ì‹œ/ì›¹ ë¡œê·¸',
                'time_based': {
                    'available': true,
                    'metrics': ['login_time', 'session_duration', 'after_hours', 'weekend_activity', 'login_frequency', 'timezone_anomaly']
                },
                'network_based': {
                    'available': true,
                    'metrics': ['ip_address', 'geo_location', 'data_volume', 'impossible_travel', 'network_device', 'bandwidth_usage', 'connection_pattern', 'proxy_bypass']
                },
                'access_based': {
                    'available': true,
                    'metrics': ['resource_access', 'auth_failures', 'file_download', 'app_usage', 'share_access']
                }
            },
            'vpn': {
                'name': 'VPN ë¡œê·¸',
                'time_based': {
                    'available': true,
                    'metrics': ['login_time', 'session_duration', 'after_hours', 'weekend_activity', 'login_frequency', 'session_overlap', 'timezone_anomaly']
                },
                'network_based': {
                    'available': true,
                    'metrics': ['ip_address', 'geo_location', 'data_volume', 'impossible_travel', 'vpn_usage', 'network_device', 'bandwidth_usage', 'connection_pattern']
                },
                'access_based': {
                    'available': false,
                    'metrics': ['auth_failures'],
                    'reason': 'VPN ë¡œê·¸ëŠ” VPN ì—°ê²° ì •ë³´ë§Œ ì œê³µí•˜ë©°, ë‚´ë¶€ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ì€ ì¶”ì í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'
                }
            },
            'dns': {
                'name': 'DNS ë¡œê·¸',
                'time_based': {
                    'available': true,
                    'metrics': ['login_time', 'after_hours', 'weekend_activity', 'timezone_anomaly']
                },
                'network_based': {
                    'available': true,
                    'metrics': ['ip_address', 'geo_location', 'impossible_travel', 'connection_pattern']
                },
                'access_based': {
                    'available': false,
                    'metrics': [],
                    'reason': 'DNS ë¡œê·¸ëŠ” ë„ë©”ì¸ ìš”ì²­ ì •ë³´ë§Œ ì œê³µí•˜ë©°, ì¸ì¦ì´ë‚˜ ê¶Œí•œ ì •ë³´ëŠ” í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'
                }
            },
            'email': {
                'name': 'ì´ë©”ì¼ ë¡œê·¸',
                'time_based': {
                    'available': true,
                    'metrics': ['login_time', 'after_hours', 'weekend_activity', 'login_frequency', 'timezone_anomaly']
                },
                'network_based': {
                    'available': true,
                    'metrics': ['ip_address', 'data_volume', 'impossible_travel', 'network_device']
                },
                'access_based': {
                    'available': true,
                    'metrics': ['resource_access', 'auth_failures', 'sensitive_data', 'file_download', 'email_behavior']
                }
            },
            'database': {
                'name': 'ë°ì´í„°ë² ì´ìŠ¤ ë¡œê·¸',
                'time_based': {
                    'available': true,
                    'metrics': ['login_time', 'session_duration', 'after_hours', 'weekend_activity', 'login_frequency', 'idle_time']
                },
                'network_based': {
                    'available': false,
                    'metrics': [],
                    'reason': 'ë°ì´í„°ë² ì´ìŠ¤ ë¡œê·¸ëŠ” ë„¤íŠ¸ì›Œí¬ ìˆ˜ì¤€ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'
                },
                'access_based': {
                    'available': true,
                    'metrics': ['resource_access', 'auth_failures', 'privilege_escalation', 'sensitive_data', 'admin_access', 'db_query', 'system_command']
                }
            }
        };

        function updateProgressBar() {
            for (let i = 1; i <= totalSteps; i++) {
                const stepCircle = document.getElementById(`step${i}`);

                if (i < currentStep) {
                    stepCircle.className = 'step-circle completed';
                    stepCircle.innerHTML = 'âœ“';
                } else if (i === currentStep) {
                    stepCircle.className = 'step-circle active';
                    stepCircle.innerHTML = i;
                } else {
                    stepCircle.className = 'step-circle inactive';
                    stepCircle.innerHTML = i;
                }
            }
        }

        function showStep(step) {
            for (let i = 1; i <= totalSteps; i++) {
                document.getElementById(`content${i}`).classList.remove('active');
            }

            document.getElementById(`content${step}`).classList.add('active');

            document.getElementById('prevBtn').disabled = step === 1;

            const nextBtn = document.getElementById('nextBtn');
            if (step === totalSteps) {
                nextBtn.innerHTML = 'í”„ë¡œíŒŒì¼ ìƒì„± ğŸš€';
                nextBtn.onclick = createProfile;
            } else {
                nextBtn.innerHTML = 'ë‹¤ìŒ â†’';
                nextBtn.onclick = nextStep;
            }
        }

        function nextStep() {
            if (currentStep < totalSteps) {
                if (validateStep(currentStep)) {
                    currentStep++;
                    showStep(currentStep);
                    updateProgressBar();

                    if (currentStep === totalSteps) {
                        updateSummary();
                    }
                }
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
                updateProgressBar();
            }
        }

        function validateStep(step) {
            switch(step) {
                case 1:
                    const profileName = document.getElementById('profileName').value.trim();
                    if (!profileName) {
                        alert('í”„ë¡œíŒŒì¼ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                        return false;
                    }
                    return true;
                case 2:
                    const selectedLogSource = document.querySelector('input[name="logSource"]:checked');
                    if (!selectedLogSource) {
                        alert('ë¡œê·¸ ì†ŒìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                        return false;
                    }
                    return true;
                case 3:
                    const metrics = document.querySelectorAll('#content3 input[type="checkbox"]:checked:not(:disabled):not(#selectAllTime):not(#selectAllNetwork):not(#selectAllAccess)');
                    if (metrics.length === 0) {
                        alert('ìµœì†Œ í•˜ë‚˜ì˜ ë¶„ì„ ë©”íŠ¸ë¦­ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                        return false;
                    }
                    return true;
                default:
                    return true;
            }
        }

        function updateMetricsBasedOnLogSource() {
            const selectedLogSource = document.querySelector('input[name="logSource"]:checked');
            if (!selectedLogSource) {
                disableAllMetrics();
                return;
            }

            const logType = selectedLogSource.value;
            const logConfig = logSourceMetrics[logType];

            const logInfo = document.getElementById('selectedLogInfo');
            const logSourceName = document.getElementById('logSourceName');
            const availableMetrics = document.getElementById('availableMetrics');

            logInfo.style.display = 'block';
            logSourceName.textContent = logConfig.name;

            const allAvailableMetrics = [];

            updateMetricCard('time', logConfig.time_based, allAvailableMetrics);
            updateMetricCard('network', logConfig.network_based, allAvailableMetrics);
            updateMetricCard('access', logConfig.access_based, allAvailableMetrics);

            availableMetrics.textContent = allAvailableMetrics.length > 0 ?
                allAvailableMetrics.join(', ') : 'ì‚¬ìš© ê°€ëŠ¥í•œ ë©”íŠ¸ë¦­ì´ ì—†ìŠµë‹ˆë‹¤';
        }

        function updateMetricCard(type, config, allAvailableMetrics) {
            const cardId = type + 'MetricCard';
            const unavailableId = type + 'MetricUnavailable';
            const card = document.getElementById(cardId);
            const unavailableDiv = document.getElementById(unavailableId);
            const selectAllId = 'selectAll' + type.charAt(0).toUpperCase() + type.slice(1);
            const selectAllCheckbox = document.getElementById(selectAllId);
            const selectAllBtn = document.getElementById(selectAllId + 'Btn');

            if (config.available) {
                card.classList.remove('disabled');
                unavailableDiv.style.display = 'none';

                // ì „ì²´ ì„ íƒ ë²„íŠ¼ í™œì„±í™”
                selectAllBtn.disabled = false;
                selectAllBtn.style.opacity = '1';
                selectAllCheckbox.disabled = false;

                const checkboxes = card.querySelectorAll('input[type="checkbox"]:not(#' + selectAllId + ')');
                let enabledCount = 0;
                let checkedCount = 0;

                checkboxes.forEach(checkbox => {
                    const metricValue = checkbox.value;
                    if (config.metrics.includes(metricValue)) {
                        checkbox.disabled = false;
                        checkbox.parentElement.style.opacity = '1';
                        allAvailableMetrics.push(checkbox.nextElementSibling.textContent);
                        enabledCount++;
                        if (checkbox.checked) {
                            checkedCount++;
                        }
                    } else {
                        checkbox.disabled = true;
                        checkbox.checked = false;
                        checkbox.parentElement.style.opacity = '0.5';
                    }
                });

                // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
                if (enabledCount > 0) {
                    selectAllCheckbox.checked = (checkedCount === enabledCount);
                    selectAllCheckbox.indeterminate = (checkedCount > 0 && checkedCount < enabledCount);
                } else {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = false;
                }

                // ì„ íƒëœ í•­ëª© ìˆ˜ ì—…ë°ì´íŠ¸
                document.getElementById(type + 'SelectedCount').textContent = checkedCount + 'ê°œ ì„ íƒë¨';
            } else {
                card.classList.add('disabled');
                unavailableDiv.style.display = 'block';
                if (config.reason) {
                    unavailableDiv.textContent = config.reason;
                }

                // ì „ì²´ ì„ íƒ ë²„íŠ¼ ë¹„í™œì„±í™”
                selectAllBtn.disabled = true;
                selectAllBtn.style.opacity = '0.5';
                selectAllCheckbox.disabled = true;
                selectAllCheckbox.checked = false;
                selectAllCheckbox.indeterminate = false;

                // ì„ íƒëœ í•­ëª© ìˆ˜ ì´ˆê¸°í™”
                document.getElementById(type + 'SelectedCount').textContent = '0ê°œ ì„ íƒë¨';

                const checkboxes = card.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.disabled = true;
                    checkbox.checked = false;
                });
            }
        }

        function disableAllMetrics() {
            const logInfo = document.getElementById('selectedLogInfo');
            const availableMetrics = document.getElementById('availableMetrics');

            logInfo.style.display = 'none';
            availableMetrics.textContent = '-';

            // ëª¨ë“  ì¹´ë“œì™€ ì²´í¬ë°•ìŠ¤ ë¹„í™œì„±í™”
            const metricTypes = ['time', 'network', 'access'];

            metricTypes.forEach(type => {
                const cardId = type + 'MetricCard';
                const unavailableId = type + 'MetricUnavailable';
                const card = document.getElementById(cardId);
                const unavailableDiv = document.getElementById(unavailableId);
                const selectAllId = 'selectAll' + type.charAt(0).toUpperCase() + type.slice(1);
                const selectAllCheckbox = document.getElementById(selectAllId);
                const selectAllBtn = document.getElementById(selectAllId + 'Btn');

                card.classList.add('disabled');
                unavailableDiv.style.display = 'block';
                unavailableDiv.textContent = 'ë¡œê·¸ ì†ŒìŠ¤ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.';

                // ì „ì²´ ì„ íƒ ë²„íŠ¼ ë¹„í™œì„±í™”
                selectAllBtn.disabled = true;
                selectAllBtn.style.opacity = '0.5';
                selectAllCheckbox.disabled = true;
                selectAllCheckbox.checked = false;
                selectAllCheckbox.indeterminate = false;

                // ì„ íƒëœ í•­ëª© ìˆ˜ ì´ˆê¸°í™”
                document.getElementById(type + 'SelectedCount').textContent = '0ê°œ ì„ íƒë¨';

                const checkboxes = card.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.disabled = true;
                    checkbox.checked = false;
                });
            });
        }

        function setupLogSourceListeners() {
            const radioButtons = document.querySelectorAll('input[name="logSource"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', function() {
                    document.querySelectorAll('.radio-item').forEach(item => {
                        item.classList.remove('selected');
                    });

                    if (this.checked) {
                        this.closest('.radio-item').classList.add('selected');
                        updateMetricsBasedOnLogSource();
                    }
                });
            });

            // ë¼ë””ì˜¤ ì•„ì´í…œ í´ë¦­ ì‹œ ë¼ë””ì˜¤ ë²„íŠ¼ ì„ íƒ
            document.querySelectorAll('.radio-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    // ì´ë¯¸ ë¼ë””ì˜¤ ë²„íŠ¼ ìì²´ë¥¼ í´ë¦­í•œ ê²½ìš° ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€
                    if (e.target.type === 'radio') return;

                    const radio = this.querySelector('input[type="radio"]');
                    if (radio && !radio.disabled) {
                        radio.checked = true;

                        // ì„ íƒ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
                        document.querySelectorAll('.radio-item').forEach(item => {
                            item.classList.remove('selected');
                        });
                        this.classList.add('selected');

                        // ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸
                        updateMetricsBasedOnLogSource();
                    }
                });
            });
        }

        function updateSummary() {
            document.getElementById('summaryName').textContent = document.getElementById('profileName').value || '-';
            document.getElementById('summaryType').textContent = document.getElementById('profileType').selectedOptions[0].textContent;
            document.getElementById('summaryScope').textContent = document.getElementById('analysisScope').selectedOptions[0].textContent;

            document.getElementById('summaryLearning').textContent = document.getElementById('learningPeriod').value + 'ì¼';

            const selectedLogSource = document.querySelector('input[name="logSource"]:checked');
            const sourcesContainer = document.getElementById('summaryDataSources');
            if (selectedLogSource) {
                const logConfig = logSourceMetrics[selectedLogSource.value];
                sourcesContainer.innerHTML = `<span class="tag">${logConfig.name}</span>`;
            } else {
                sourcesContainer.textContent = 'ì„ íƒëœ ì†ŒìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤';
            }

            // "ì „ì²´ ì„ íƒ" ì²´í¬ë°•ìŠ¤ëŠ” ì œì™¸í•˜ê³  ì„ íƒëœ ë©”íŠ¸ë¦­ë§Œ ê°€ì ¸ì˜¤ê¸°
            const selectedMetrics = Array.from(document.querySelectorAll('#content3 input[type="checkbox"]:checked:not(:disabled):not(#selectAllTime):not(#selectAllNetwork):not(#selectAllAccess)'))
                .map(cb => cb.nextElementSibling.textContent);

            console.log('ì„ íƒëœ ë©”íŠ¸ë¦­:', selectedMetrics); // ë””ë²„ê¹…ìš©

            const metricsContainer = document.getElementById('summaryMetrics');
            if (selectedMetrics.length > 0) {
                metricsContainer.innerHTML = selectedMetrics.map(metric => `<span class="tag">${metric}</span>`).join('');
            } else {
                metricsContainer.textContent = 'ì„ íƒëœ ë©”íŠ¸ë¦­ì´ ì—†ìŠµë‹ˆë‹¤';
            }

            document.getElementById('summarySensitivity').textContent = document.getElementById('anomalyThreshold').selectedOptions[0].textContent;
            document.getElementById('summaryRiskScore').textContent = document.getElementById('riskScore').value + 'ì ';

            // ì•Œë¦¼ ì„¤ì • ì²´í¬ë°•ìŠ¤ ëª…í™•í•˜ê²Œ ì‹ë³„
            const selectedAlerts = Array.from(document.querySelectorAll('#content4 input[type="checkbox"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);

            console.log('ì„ íƒëœ ì•Œë¦¼:', selectedAlerts); // ë””ë²„ê¹…ìš©

            const alertsContainer = document.getElementById('summaryAlerts');
            if (selectedAlerts.length > 0) {
                alertsContainer.innerHTML = selectedAlerts.map(alert => `<span class="tag">${alert}</span>`).join('');
            } else {
                alertsContainer.textContent = 'ì•Œë¦¼ ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤';
            }
        }

        function createProfile() {
            const btn = document.getElementById('nextBtn');
            btn.disabled = true;
            btn.innerHTML = 'ìƒì„± ì¤‘... â³';

            try {
                // í”„ë¡œíŒŒì¼ ë°ì´í„° ìˆ˜ì§‘
                const profileData = {
                    id: currentEditProfile ? currentEditProfile : generateUniqueId(),
                    name: document.getElementById('profileName').value,
                    description: document.getElementById('profileDescription').value,
                    profileType: document.getElementById('profileType').value,
                    analysisScope: document.getElementById('analysisScope').value,

                    // ë¡œê·¸ ì†ŒìŠ¤ ì •ë³´
                    logSource: document.querySelector('input[name="logSource"]:checked')?.value,
                    logSourceName: document.querySelector('input[name="logSource"]:checked') ?
                        logSourceMetrics[document.querySelector('input[name="logSource"]:checked').value].name : null,
                    learningPeriod: document.getElementById('learningPeriod').value,

                    // ë¶„ì„ ë©”íŠ¸ë¦­ - ì²´í¬ëœ í•­ëª©ë“¤ì˜ ë¼ë²¨ í…ìŠ¤íŠ¸ ìˆ˜ì§‘ (ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ ì œì™¸)
                    selectedMetrics: Array.from(document.querySelectorAll('#content3 input[type="checkbox"]:checked:not(:disabled):not(#selectAllTime):not(#selectAllNetwork):not(#selectAllAccess)'))
                        .map(cb => cb.nextElementSibling.textContent),

                    // ì„ê³„ê°’ ì„¤ì •
                    anomalyThreshold: document.getElementById('anomalyThreshold').selectedOptions[0].textContent,
                    alertSeverity: document.getElementById('alertSeverity').value,
                    riskScore: document.getElementById('riskScore').value,

                    // ì•Œë¦¼ ì„¤ì •
                    alerts: Array.from(document.querySelectorAll('#content4 input[type="checkbox"]:checked'))
                        .map(cb => cb.nextElementSibling.textContent),

                    // ìƒì„±/ìˆ˜ì • ì‹œê°„
                    createdAt: currentEditProfile ?
                        (getProfileById(currentEditProfile)?.createdAt || new Date().toISOString()) :
                        new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                const saveResult = saveProfile(profileData);

                if (saveResult) {
                    alert(`UBA í”„ë¡œíŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ${currentEditProfile ? 'ìˆ˜ì •' : 'ìƒì„±'}ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì‹œìŠ¤í…œì´ ê³§ í•™ìŠµì„ ì‹œì‘í•  ì˜ˆì •ì…ë‹ˆë‹¤.`);
                    btn.innerHTML = 'ì™„ë£Œ âœ…';

                    // í˜ì´ì§€ ì´ë™ ë¡œì§ì„ ì¦‰ì‹œ ì‹¤í–‰
                    if (isModalMode()) {
                        // ë¶€ëª¨ ì°½ì— ë‹«ê¸° ì‹ í˜¸ ì „ë‹¬
                        window.parent.closeWizardModal();
                    } else {
                        // ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™
                        window.location.href = 'index.html';
                    }
                } else {
                    alert('í”„ë¡œíŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    btn.disabled = false;
                    btn.innerHTML = 'í”„ë¡œíŒŒì¼ ìƒì„± ğŸš€';
                }
            } catch (error) {
                console.error('í”„ë¡œíŒŒì¼ ìƒì„± ì˜¤ë¥˜:', error);
                alert('í”„ë¡œíŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                btn.disabled = false;
                btn.innerHTML = 'í”„ë¡œíŒŒì¼ ìƒì„± ğŸš€';
            }
        }

        // í”„ë¡œíŒŒì¼ ì €ì¥ í•¨ìˆ˜
        function saveProfile(profileData) {
            try {
                // ê¸°ì¡´ í”„ë¡œíŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
                let profiles = localStorage.getItem('ubaProfiles');
                profiles = profiles ? JSON.parse(profiles) : [];

                // í¸ì§‘ ëª¨ë“œì¸ ê²½ìš° ê¸°ì¡´ í”„ë¡œíŒŒì¼ ì—…ë°ì´íŠ¸, ì•„ë‹ˆë©´ ìƒˆë¡œ ì¶”ê°€
                if (currentEditProfile) {
                    const index = profiles.findIndex(p => p.id === currentEditProfile);
                    if (index !== -1) {
                        profiles[index] = profileData;
                    } else {
                        profiles.push(profileData);
                    }
                } else {
                    profiles.push(profileData);
                }

                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                localStorage.setItem('ubaProfiles', JSON.stringify(profiles));

                // ì €ì¥ í™•ì¸ - ì‹¤ì œë¡œ ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì¸
                const savedProfiles = localStorage.getItem('ubaProfiles');
                const parsedProfiles = savedProfiles ? JSON.parse(savedProfiles) : [];
                const savedProfile = parsedProfiles.find(p => p.id === profileData.id);

                return !!savedProfile; // ì €ì¥ëœ í”„ë¡œíŒŒì¼ì´ ì¡´ì¬í•˜ë©´ true ë°˜í™˜
            } catch (error) {
                console.error('í”„ë¡œíŒŒì¼ ì €ì¥ ì˜¤ë¥˜:', error);
                return false;
            }
        }

        // ê³ ìœ  ID ìƒì„±
        function generateUniqueId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // IDë¡œ í”„ë¡œíŒŒì¼ ê°€ì ¸ì˜¤ê¸°
        function getProfileById(id) {
            const profiles = localStorage.getItem('ubaProfiles');
            if (!profiles) return null;

            const profileArray = JSON.parse(profiles);
            return profileArray.find(profile => profile.id === id);
        }

        // í¸ì§‘í•  í”„ë¡œíŒŒì¼ ID
        let currentEditProfile = null;

        // URLì—ì„œ í¸ì§‘ íŒŒë¼ë¯¸í„° í™•ì¸
        function checkEditMode() {
            const urlParams = new URLSearchParams(window.location.search);
            const editId = urlParams.get('edit');

            if (editId) {
                currentEditProfile = editId;
                loadProfileData(editId);
            }

            // ëª¨ë‹¬ ëª¨ë“œì¸ ê²½ìš° ì·¨ì†Œ ë²„íŠ¼ ë™ì‘ ë³€ê²½
            if (isModalMode()) {
                const cancelBtn = document.querySelector('.btn-secondary[style*="margin-right: auto"]');
                if (cancelBtn) {
                    cancelBtn.onclick = function() {
                        if (confirm('ì‘ì—…ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                            window.parent.closeWizardModal();
                        }
                    };
                }
            }
        }

        // ëª¨ë‹¬ ëª¨ë“œì¸ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function isModalMode() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('modal') === 'true';
        }

        // í”„ë¡œíŒŒì¼ ë°ì´í„° ë¡œë“œ
        function loadProfileData(profileId) {
            const profile = getProfileById(profileId);
            if (!profile) return;

            // í˜ì´ì§€ íƒ€ì´í‹€ ì—…ë°ì´íŠ¸
            document.querySelector('.header h1').textContent = 'UBA í”„ë¡œíŒŒì¼ í¸ì§‘';
            document.querySelector('.header p').textContent = profile.name + ' í”„ë¡œíŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤';

            // ê¸°ë³¸ ì •ë³´ ì…ë ¥
            document.getElementById('profileName').value = profile.name;
            document.getElementById('profileDescription').value = profile.description || '';

            // ì…€ë ‰íŠ¸ ë°•ìŠ¤ ê°’ ì„¤ì •
            setSelectValue('profileType', profile.profileType);
            setSelectValue('analysisScope', profile.analysisScope);
            setSelectValue('learningPeriod', profile.learningPeriod);

            // ë¡œê·¸ ì†ŒìŠ¤ ì„ íƒ
            if (profile.logSource) {
                const logSourceRadio = document.getElementById(profile.logSource + 'Logs');
                if (logSourceRadio) {
                    logSourceRadio.checked = true;
                    logSourceRadio.closest('.radio-item').classList.add('selected');
                    updateMetricsBasedOnLogSource();
                }
            }

            // ì„ê³„ê°’ ì„¤ì •
            setSelectValue('anomalyThreshold', getKeyByText('anomalyThreshold', profile.anomalyThreshold));
            setSelectValue('alertSeverity', profile.alertSeverity);

            const riskScoreSlider = document.getElementById('riskScore');
            riskScoreSlider.value = profile.riskScore || 70;
            document.getElementById('riskScoreValue').textContent = riskScoreSlider.value;

            // ì•Œë¦¼ ì„¤ì •
            const alertCheckboxes = document.querySelectorAll('#content4 input[type="checkbox"]');
            alertCheckboxes.forEach(checkbox => {
                checkbox.checked = profile.alerts && profile.alerts.includes(checkbox.nextElementSibling.textContent);
            });

            // ë©”íŠ¸ë¦­ ì„¤ì • (ì•½ê°„ ë”œë ˆì´ë¥¼ ì¤˜ì„œ ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸ê°€ ì™„ë£Œëœ í›„ì— ì‹¤í–‰)
            setTimeout(() => {
                const metricCheckboxes = document.querySelectorAll('#content3 input[type="checkbox"]:not(:disabled)');
                metricCheckboxes.forEach(checkbox => {
                    checkbox.checked = profile.selectedMetrics &&
                        profile.selectedMetrics.includes(checkbox.nextElementSibling.textContent);
                });
            }, 300);
        }

        // ì…€ë ‰íŠ¸ ë°•ìŠ¤ ê°’ ì„¤ì • í—¬í¼ í•¨ìˆ˜
        function setSelectValue(selectId, value) {
            const select = document.getElementById(selectId);
            if (select && value) {
                for (let i = 0; i < select.options.length; i++) {
                    if (select.options[i].value === value) {
                        select.selectedIndex = i;
                        break;
                    }
                }
            }
        }

        // í…ìŠ¤íŠ¸ë¡œ ì…€ë ‰íŠ¸ ë°•ìŠ¤ ê°’ ì°¾ê¸°
        function getKeyByText(selectId, text) {
            const select = document.getElementById(selectId);
            if (select && text) {
                for (let i = 0; i < select.options.length; i++) {
                    if (select.options[i].textContent === text) {
                        return select.options[i].value;
                    }
                }
            }
            return null;
        }

        function resetWizard() {
            currentStep = 1;
            showStep(currentStep);
            updateProgressBar();

            document.getElementById('profileName').value = '';
            document.getElementById('profileDescription').value = '';
            document.getElementById('profileType').selectedIndex = 0;
            document.getElementById('analysisScope').selectedIndex = 0;
            document.getElementById('learningPeriod').selectedIndex = 2;
            document.getElementById('anomalyThreshold').selectedIndex = 1;
            document.getElementById('alertSeverity').selectedIndex = 2;
            document.getElementById('riskScore').value = 70;
            document.getElementById('riskScoreValue').textContent = '70';

            const radioButtons = document.querySelectorAll('input[name="logSource"]');
            radioButtons.forEach(radio => {
                radio.checked = false;
                radio.closest('.radio-item').classList.remove('selected');
            });

            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => {
                cb.checked = false;
                cb.disabled = false;
            });

            document.getElementById('emailAlert').checked = true;
            document.getElementById('dashboardAlert').checked = true;

            disableAllMetrics();

            // í¸ì§‘ ëª¨ë“œ ì´ˆê¸°í™”
            currentEditProfile = null;

            // í˜ì´ì§€ íƒ€ì´í‹€ ë³µì›
            document.querySelector('.header h1').textContent = 'UBA í”„ë¡œíŒŒì¼ ë§ˆë²•ì‚¬';
            document.querySelector('.header p').textContent = 'ì‚¬ìš©ì ë° ì—”í„°í‹° í–‰ë™ ë¶„ì„ í”„ë¡œíŒŒì¼ì„ ì‰½ê²Œ ì„¤ì •í•˜ì„¸ìš”';
        }

        // ìœ„í—˜ ì ìˆ˜ ìŠ¬ë¼ì´ë” ì—…ë°ì´íŠ¸
        document.getElementById('riskScore').addEventListener('input', function() {
            document.getElementById('riskScoreValue').textContent = this.value;
        });

        // ì´ˆê¸°í™”
        updateProgressBar();
        showStep(currentStep);

        setTimeout(() => {
            setupLogSourceListeners();
            disableAllMetrics();
            checkEditMode(); // í¸ì§‘ ëª¨ë“œ í™•ì¸
        }, 100);

        // ì·¨ì†Œ ë²„íŠ¼ ì¶”ê°€
        const buttonGroup = document.querySelector('.button-group');
        const cancelBtn = document.createElement('button');
        cancelBtn.className = 'btn btn-secondary';
        cancelBtn.textContent = 'ì·¨ì†Œ';
        cancelBtn.style.marginRight = 'auto';
        cancelBtn.onclick = function() {
            if (confirm('ì‘ì—…ì„ ì·¨ì†Œí•˜ê³  ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // ëª¨ë‹¬ ëª¨ë“œì¸ì§€ í™•ì¸
                if (isModalMode()) {
                    window.parent.closeWizardModal();
                } else {
                    window.location.href = 'index.html';
                }
            }
        };

        // prevBtn ì•ì— ì·¨ì†Œ ë²„íŠ¼ ì‚½ì…
        buttonGroup.insertBefore(cancelBtn, document.getElementById('prevBtn'));
    </script>
</body>
</html>
